# PyStock

주식 정보를 크롤링하여 주요 정보와 시세 그래프를 보여주는 프로그램입니다.
주식 검색, 주식 비교, 인기 주식 기능이 있습니다.

## 📋 프로젝트 기본 정보

- **프로젝트명**: pystock
- **목적**: 크롤링 데이터를 활용하여 주식 정보를 제공하는 프로그램 제작
- **주요 기능**:
    - 주식 검색 기능
    - 주식 비교 기능
    - 인기 주식 기능
    - 주식 코드 추출
    - 주식 정보, 시세 정보, 주식 순위 크롤링
    - 캔들 차트 그리기 및 저장
    - 시세 그래프 출력
    - 주요 정보 출력
    - 인기 주식 순위 출력 (거래량 기준)

## 🛠 기술 스택

- **사용 언어**: Python
- **사용 라이브러리**: PySimpleGUI, requests, BeautifulSoup, mplfinance, pandas, io, os

## 📝  주요 함수 설명

### 1. get_stock_code
- 설명 : 사용자가 입력한 종목 이름을 바탕으로 한국거래소(KRX)에서 해당 종목의 종목 코드를 찾아 반환합니다.
- 출력 : (회사명, 종목코드) 튜플 반환. 일치하는 종목이 없을 경우 (None, None) 반환.

### 2. get_stock_info
- 설명 : 네이버 금융에서 종목 코드에 해당하는 상세 주식 정보를 크롤링합니다.
- 수집 정보 :
    - 현재가, 전일대비, 등락률
    - 시가/고가/저가/거래량/거래대금
    - 시가총액, PER, EPS, 추정 PER/EPS
    - PBR, BPS, 배당수익률, 외국인소진율, 동일업종 PER
- 출력 : 종목 정보가 담긴 딕셔너리 반환 (dict)

### 3. get_price_table
- 설명 : 네이버 금융의 일별 시세 데이터를 크롤링하여 OHLCV 형태의 DataFrame으로 반환합니다.
- 동작 : 지정한 페이지 수만큼 데이터를 가져와 하나의 테이블로 병합합니다.
- 출력 : Date를 인덱스로 하는 시세 데이터프레임 (pd.DataFrame)

### 4. get_popular_stock
- 설명 : 네이버 금융에서 거래량 기준 상위 인기 주식 정보를 가져옵니다.
- 수집 정보 : 종목명, 현재가, 전일비, 등락률
- 출력 : 각 종목 정보를 담은 딕셔너리 리스트 반환 (List[Dict])

### 5. plot_candle_chart
- 설명 : 주어진 시세 데이터프레임을 기반으로 캔들차트를 그리고 이미지 파일로 저장합니다.
- 사용 라이브러리 : mplfinance
- 입력 : OHLCV 형태의 DataFrame, 저장할 파일명

### 6. resample_ohlcv
- 설명 : 일봉 데이터를 주봉 혹은 월봉으로 변환합니다.
- 입력 : OHLCV 형태의 DataFrame, 리샘플링 규칙 ('W' 또는 'M')
- 출력 : 리샘플링된 OHLCV DataFrame

### 7. search_stock_window
- 설명 : 사용자가 주식 종목명을 입력하여 정보를 조회할 수 있는 인터페이스 창입니다.
- 기능 :
    - 주식 검색
    - 일봉/주봉/월봉 선택
    - 시세 차트 출력
    - 종목 상세 정보 표시

### 8. compare_stock_window
- 설명 : 두 종목을 비교 분석할 수 있는 창을 제공합니다.
- 기능 :
    - 두 종목 시세 차트 비교
    - 종목별 상세 정보 나란히 출력
    - 주기(일봉/주봉/월봉) 변경 기능 포함

### 9. popular_stock_window
- 설명 : 인기 주식 목록을 표 형태로 보여주는 창입니다.
- 기능 :
    - 인기 주식 표 출력 (거래량 기준)
    - 종목 클릭 시 상세 정보 확인 가능 (검색 창 전환)

### 10. main_menu
- 설명 : 프로그램 실행 시 표시되는 메인 메뉴 인터페이스입니다.
- 기능 :
    - 주식 검색
    - 주식 비교
    - 인기 주식
    - 프로그램 종료